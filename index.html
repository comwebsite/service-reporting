<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Service Reporting</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#ffffff;
    --glass-bg: rgba(255,255,255,0.55);
    --glass-border: rgba(255,255,255,0.6);
    --accent: #4b8cff;
    --muted: #6b7280;
    --shadow: 0 8px 30px rgba(16,24,40,0.08);
    --radius: 16px;
  }
  html,body{
    height:100%;
    margin:0;
    font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
    background: linear-gradient(180deg,#fbfdff 0%, #ffffff 100%);
    color:#0f172a;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  /* Page layout */
  .wrap{
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:48px 20px;
    box-sizing:border-box;
  }

  /* Card with glassmorphism */
  .card{
    width:100%;
    max-width:600px;
    background: linear-gradient(180deg, rgba(255,255,255,0.7), rgba(255,255,255,0.55));
    border-radius:var(--radius);
    padding:28px;
    box-shadow: var(--shadow);
    border: 1px solid var(--glass-border);
    backdrop-filter: blur(12px) saturate(120%);
    -webkit-backdrop-filter: blur(12px) saturate(120%);
    position:relative;
    overflow:hidden;
    transition:transform .45s cubic-bezier(.2,.9,.2,1), box-shadow .3s;
  }
  .card::before{
    content:"";
    position:absolute;
    inset: -40% -20% auto -20%;
    height:220px;
    background: radial-gradient(600px 200px at 10% 10%, rgba(75,140,255,0.08), transparent 20%),
                radial-gradient(400px 120px at 90% 80%, rgba(75,140,255,0.06), transparent 20%);
    transform: rotate(-6deg);
    pointer-events:none;
  }
  .card:hover{ transform: translateY(-6px); box-shadow: 0 20px 50px rgba(16,24,40,0.12); }

  header.title{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    margin-bottom:18px;
  }
  .brand{
    display:flex;
    align-items:center;
    gap:12px;
  }
  .logo{
    width:56px;
    height:56px;
    border-radius:12px;
    background: linear-gradient(135deg,var(--accent), #7dd3fc);
    display:flex;
    align-items:center;
    justify-content:center;
    color:white;
    font-weight:800;
    box-shadow: 0 6px 18px rgba(75,140,255,0.18);
  }
  h1{ font-size:20px; margin:0; letter-spacing:-0.2px; }
  p.lead{ margin:0; color:var(--muted); font-size:13px; }

  form{
    margin-top:12px;
    display:grid;
    gap:14px;
  }

  /* Row with two items (Date and Time) */
  .row{
    display:flex;
    gap:12px;
    align-items:stretch;
  }
  .field{
    flex:1;
    background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.45));
    border-radius:12px;
    padding:12px;
    border:1px solid rgba(15,23,42,0.04);
    box-shadow: 0 6px 18px rgba(12,18,30,0.03) inset;
    transition: transform .18s ease, box-shadow .18s ease;
    display:flex;
    flex-direction:column;
  }
  .field:focus-within{ transform: translateY(-4px); box-shadow: 0 12px 30px rgba(75,140,255,0.06); }

  label{
    font-size:12px;
    color:var(--muted);
    margin-bottom:8px;
    display:block;
  }
  input[type="text"], input[type="number"], select{
    border:0;
    outline:0;
    background:transparent;
    font-size:16px;
    color: #071033;
    padding:6px 0;
    width:100%;
  }
  input[readonly]{ color:#334155; font-weight:600; }

  /* Single column fields */
  .col{
    display:grid;
    grid-template-columns: 1fr;
    gap:12px;
  }

  /* Submit area */
  .actions{
    display:flex;
    gap:12px;
    align-items:center;
    justify-content:space-between;
    margin-top:6px;
  }
  .btn{
    background: linear-gradient(90deg,var(--accent), #7dd3fc);
    color:white;
    border:0;
    padding:10px 16px;
    border-radius:12px;
    font-weight:600;
    cursor:pointer;
    box-shadow: 0 10px 30px rgba(75,140,255,0.18);
    transition: transform .18s ease, box-shadow .18s ease, opacity .12s;
  }
  .btn:active{ transform: translateY(1px) scale(.998); }
  .btn.secondary{
    background:transparent;
    color:var(--accent);
    border:1px solid rgba(75,140,255,0.12);
    box-shadow:none;
  }

  .note{ color:var(--muted); font-size:13px; }

  /* small helper text and errors */
  .error{ color:#ef4444; font-size:13px; display:none; margin-top:6px; }
  .success{ color:#059669; font-size:13px; display:none; margin-top:6px; }

  footer{
    margin-top:18px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    color:var(--muted);
    font-size:13px;
  }

  /* subtle floating animation for inputs */
  @keyframes floaty {
    0% { transform: translateY(0px); }
    50% { transform: translateY(-6px); }
    100% { transform: translateY(0px); }
  }
  .logo{ animation: floaty 6s ease-in-out infinite; }

  /* Responsive */
  @media (max-width:720px){
    .row{ flex-direction:column; }
    .actions{ flex-direction:column; align-items:stretch; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <main class="card" role="main" aria-labelledby="title">
      <header class="title">
        <div class="brand">
          <div class="logo">SR</div>
          <div>
            <h1 id="title">Service Reporting</h1>
            <p class="lead">Quick daily report — version 4.0</p>
          </div>
        </div>
        <div style="text-align:right">
          <div style="font-size:12px;color:var(--muted)">Clean glass UI • animated</div>
          <div style="font-size:12px;color:var(--muted)">White theme</div>
        </div>
      </header>

      <form id="reportForm" autocomplete="off">
        <!-- Row 1: Date and Time (in one line) -->
        <div class="row">
          <div class="field">
            <label for="date">Date</label>
            <input id="date" name="Date" type="text" readonly />
          </div>
          <div class="field">
            <label for="time">Time</label>
            <input id="time" name="Time" type="text" readonly />
          </div>
        </div>

        <!-- Row 2: Temperature -->
        <div class="col">
          <div class="field">
            <label for="temperature">Temperature</label>
            <input id="temperature" name="Temperature" type="text"
              placeholder="e.g. 23.5 or +5, -2"
              inputmode="decimal"
              pattern="^[0-9\+\-\,\.]+$"
              title="Только цифры и символы , . + -"
              required />
            
          </div>
        </div>

        <!-- Row 3: Working hours -->
        <div class="col">
          <div class="field">
            <label for="hours">Working hours</label>
            <input id="hours" name="WorkingHours" type="text"
              placeholder="e.g. 8 or 8.5 or 08:30"
              inputmode="numeric"
              pattern="^[0-9\.\,\:\;]+$"
              title="Только цифры и символы . , : ;"
              required />
           
          </div>
        </div>

        <!-- Row 4: How many people have you helped -->
        <div class="col">
          <div class="field">
            <label for="helped">How many people have you helped</label>
            <input id="helped" name="HelpedCount" type="text"
              placeholder="e.g. 3"
              inputmode="numeric"
              pattern="^[0-9]+$"
              title="Только целое число"
              required />
            
          </div>
        </div>

        <!-- Row 5: Work difficulty -->
        <div class="col">
          <div class="field">
            <label for="difficulty">Work difficulty</label>
            <select id="difficulty" name="WorkDifficulty" required>
              <option value="">-- Выберите --</option>
              <option value="Neutral">Neutral</option>
              <option value="Moderate">Moderate</option>
              <option value="Hard">Hard</option>
            </select>
            
          </div>
        </div>

        <!-- Row 6: Reported by -->
        <div class="col">
          <div class="field">
            <label for="reportedBy">Reported by</label>
            <input id="reportedBy" name="ReportedBy" type="text"
              placeholder="Ваше имя"
              pattern="^[A-Za-zА-Яа-яЁё\s\-\']+$"
              title="Только буквы, пробелы, дефис или апостроф"
              required />
         
          </div>
        </div>

        <!-- Hidden fields for FormSubmit -->
        <input type="hidden" name="_subject" value="Service Reporting Form Submission">
        <input type="hidden" name="_next" value="">
        <input type="hidden" name="_captcha" value="false">

        <div class="actions">
          <div>
            <button type="submit" class="btn">Submit</button>
            <button type="button" id="resetBtn" class="btn secondary">Reset</button>
          </div>
          <div style="text-align:right">
            <div id="status" class="note">Готово к отправке</div>
            <div id="error" class="error"></div>
            <div id="success" class="success"></div>
          </div>
        </div>
      </form>

      <footer>
        <div>© Service Reporting</div>
        <div>version 4.0</div>
      </footer>
    </main>
  </div>

<script>
  // --- Utilities ---
  const $ = (sel) => document.querySelector(sel);

  // Set date and time initially and keep time updated
  function pad(n){ return n<10? '0'+n : n; }
  function updateDateTime(){
    const now = new Date();
    const dateStr = now.toLocaleDateString(undefined, {year:'numeric', month:'2-digit', day:'2-digit'});
    const timeStr = now.toLocaleTimeString(undefined, {hour:'2-digit', minute:'2-digit', second:'2-digit'});
    $('#date').value = dateStr;
    $('#time').value = timeStr;
  }
  updateDateTime();
  setInterval(updateDateTime, 1000);

  // Form validation helpers
  function matchesPattern(el){
    const pat = el.getAttribute('pattern');
    if(!pat) return true;
    const re = new RegExp(pat);
    return re.test(el.value.trim());
  }

  function showError(msg){
    const e = $('#error');
    e.textContent = msg;
    e.style.display = msg ? 'block' : 'none';
  }
  function showSuccess(msg){
    const s = $('#success');
    s.textContent = msg;
    s.style.display = msg ? 'block' : 'none';
  }

  // Reset button
  $('#resetBtn').addEventListener('click', () => {
    $('#reportForm').reset();
    updateDateTime();
    showError('');
    showSuccess('');
    $('#status').textContent = 'Форма очищена';
    setTimeout(()=> $('#status').textContent = 'Готово к отправке', 1800);
  });

  // Modern FormSubmit AJAX endpoint
  // Using FormSubmit AJAX: https://formsubmit.co/ajax/<email>
  const endpoint = 'https://formsubmit.co/ajax/communityofdevelopingcraftsmen@gmail.com';

  document.getElementById('reportForm').addEventListener('submit', async function(e){
    e.preventDefault();
    showError('');
    showSuccess('');
    $('#status').textContent = 'Проверка данных...';

    // Basic validation per-field
    const temp = $('#temperature');
    const hours = $('#hours');
    const helped = $('#helped');
    const reportedBy = $('#reportedBy');
    const difficulty = $('#difficulty');

    if(!matchesPattern(temp) || temp.value.trim()===''){
      showError('Поле Temperature: только цифры и символы , . + -');
      temp.focus(); return;
    }
    if(!matchesPattern(hours) || hours.value.trim()===''){
      showError('Поле Working hours: только цифры и символы . , : ;');
      hours.focus(); return;
    }
    if(!matchesPattern(helped) || helped.value.trim()===''){
      showError('Поле How many people have you helped: только целое число');
      helped.focus(); return;
    }
    if(!difficulty.value){
      showError('Выберите Work difficulty');
      difficulty.focus(); return;
    }
    if(!matchesPattern(reportedBy) || reportedBy.value.trim()===''){
      showError('Поле Reported by: только буквы и пробелы');
      reportedBy.focus(); return;
    }

    // Prepare form data
    const form = e.target;
    const formData = new FormData(form);

    // Add date/time values (they are readonly inputs already included)
    formData.set('Date', $('#date').value);
    formData.set('Time', $('#time').value);

    // Set _next to a friendly message page (optional). We'll set to current location.
    formData.set('_next', window.location.href);

    $('#status').textContent = 'Отправка...';

    try{
      const resp = await fetch(endpoint, {
        method: 'POST',
        body: formData,
        headers: {
          'Accept': 'application/json'
        }
      });

      if(!resp.ok){
        const text = await resp.text();
        throw new Error('Ошибка отправки: ' + resp.status + ' ' + text);
      }
      const data = await resp.json();
      // success
      showSuccess('Форма успешно отправлена. Спасибо!');
      $('#status').textContent = 'Отправлено';
      // Optionally reset after success
      setTimeout(()=> {
        $('#reportForm').reset();
        updateDateTime();
        $('#status').textContent = 'Готово к отправке';
      }, 1800);
    }catch(err){
      console.error(err);
      showError('Не удалось отправить форму. Попробуйте ещё раз. ' + (err.message || ''));
      $('#status').textContent = 'Ошибка';
    }
  });

  // Extra: prevent letters on numeric-like fields while typing (UX)
  function allowChars(el, allowedRegex){
    el.addEventListener('input', () => {
      const v = el.value;
      const filtered = v.split('').filter(ch => allowedRegex.test(ch)).join('');
      if(filtered !== v) el.value = filtered;
    });
  }
  // Temperature: digits and , . + -
  allowChars($('#temperature'), /[0-9\+\-\,\.]/);
  // Hours: digits and . , : ;
  allowChars($('#hours'), /[0-9\.\,\:\;]/);
  // Helped: digits only
  allowChars($('#helped'), /[0-9]/);
  // ReportedBy: letters, spaces, hyphen, apostrophe (Cyrillic and Latin)
  allowChars($('#reportedBy'), /[A-Za-zА-Яа-яЁё\s\-\']/);

  // Accessibility: focus first input
  window.addEventListener('load', ()=> {
    $('#temperature').focus();
  });
</script>
</body>
</html>