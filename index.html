<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Service Reporting — version 3.1</title>

<!-- FormSubmit библиотека (по требованию) -->
<script src="https://formsubmit.co/js/formsubmit.min.js" defer></script>

<style>
  :root{
    --bg: #ffffff;
    --card: #fbfdff;
    --accent-a: #0b6efd;
    --accent-b: #7c3aed;
    --muted: #6b7280;
    --danger: #ef4444;
    --success: #16a34a;
    --radius: 16px;
    --input-h: 56px; /* одинаковая высота всех ячеек */
    --max-w: 600px;
  }

  html,body{
    height:100%;
    margin:0;
    font-family: Inter, "Segoe UI", Roboto, Arial, sans-serif;
    background:
      radial-gradient(800px 400px at 10% 10%, rgba(124,58,237,0.04), transparent 8%),
      radial-gradient(700px 350px at 90% 90%, rgba(11,110,253,0.03), transparent 8%),
      var(--bg);
    color:#071029;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding:28px;
    box-sizing:border-box;
  }

  /* Контейнер */
  .wrap{
    max-width:var(--max-w);
    margin:0 auto;
    display:flex;
    flex-direction:column;
    gap:18px;
  }

  header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
  }
  .brand{ display:flex; gap:14px; align-items:center; }
  .logo{
    width:64px; height:64px; border-radius:12px;
    background:linear-gradient(135deg,var(--accent-a),var(--accent-b));
    display:flex; align-items:center; justify-content:center;
    color:white; font-weight:800; font-size:20px;
    box-shadow: 0 12px 40px rgba(11,110,253,0.12);
  }
  .title h1{ margin:0; font-size:20px; }
  .title p{ margin:4px 0 0 0; color:var(--muted); font-size:13px; }
  .version{ font-size:13px; color:var(--muted); padding:8px 12px; border-radius:10px; background:rgba(7,16,41,0.02); }

  /* Карточка формы */
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,0.98), var(--card));
    border-radius:20px;
    padding:26px;
    box-shadow: 0 18px 60px rgba(7,16,41,0.04);
    border:1px solid rgba(11,110,253,0.04);
    position:relative;
    overflow:hidden;
  }

  h2{ margin:0 0 12px 0; font-size:16px; }

  form{
    display:flex;
    flex-direction:column;
    gap:14px;
  }

  /* Date и Time в одной строке */
  .row-inline{
    display:flex;
    gap:12px;
    align-items:flex-start;
  }
  .row-inline .field{ flex:1; }

  /* Все остальные поля в одном столбце (один под другим) */
  .stack{ display:flex; flex-direction:column; gap:12px; }

  label{
    font-size:12px; color:var(--muted); margin-bottom:6px; font-weight:700;
  }

  input[type="text"], input[type="time"], select, .fake-input{
    height:var(--input-h);
    border-radius:12px;
    border:1px solid rgba(7,16,41,0.06);
    padding:10px 14px;
    font-size:15px;
    background:transparent;
    outline:none;
    transition: box-shadow .18s, transform .12s, border-color .12s;
    width:100%;
    box-sizing:border-box;
  }
  input::placeholder{ color:#bfc9d9; }

  select{
    appearance:none;
    background-image: linear-gradient(45deg, transparent 50%, rgba(7,16,41,0.45) 50%), linear-gradient(135deg, rgba(7,16,41,0.45) 50%, transparent 50%);
    background-position: calc(100% - 18px) calc(1em + 2px), calc(100% - 13px) calc(1em + 2px);
    background-size: 6px 6px, 6px 6px;
    background-repeat: no-repeat;
    padding-right:40px;
  }

  input:focus, select:focus{
    box-shadow: 0 10px 30px rgba(11,110,253,0.08);
    border-color: rgba(11,110,253,0.18);
    transform:translateY(-2px);
  }

  .calendar{ position:relative; }
  .cal-btn{
    position:absolute; right:8px; top:50%; transform:translateY(-50%);
    width:40px; height:40px; border-radius:10px;
    display:flex; align-items:center; justify-content:center;
    background:linear-gradient(180deg, rgba(11,110,253,0.06), rgba(124,58,237,0.04));
    cursor:pointer;
  }

  .hint{ font-size:12px; color:var(--danger); margin-top:6px; display:none; }
  .hint.show{ display:block; }

  /* Кнопка по центру */
  .actions{ display:flex; justify-content:center; margin-top:6px; }
  button.submit{
    background:linear-gradient(90deg,var(--accent-a),var(--accent-b));
    color:white; border:none; padding:14px 28px; border-radius:14px; font-weight:800; cursor:pointer;
    box-shadow: 0 18px 50px rgba(11,110,253,0.14);
    transition: transform .12s ease, box-shadow .12s ease;
    font-size:15px;
  }
  button.submit:hover{ transform:translateY(-3px); box-shadow: 0 26px 70px rgba(11,110,253,0.18); }
  button.submit:active{ transform:translateY(0); }

  /* Toast */
  .toast{
    position:fixed; right:20px; bottom:20px; background:linear-gradient(90deg,var(--accent-a),var(--accent-b));
    color:white; padding:12px 16px; border-radius:12px; box-shadow: 0 12px 30px rgba(11,110,253,0.18);
    transform:translateY(20px); opacity:0; transition:all .28s; z-index:9999;
  }
  .toast.show{ transform:translateY(0); opacity:1; }

  /* Адаптация */
  @media (max-width:880px){
    .row-inline{ flex-direction:column; }
    .logo{ width:56px; height:56px; font-size:18px; border-radius:12px; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">SR</div>
        <div class="title">
          <h1>Service Reporting</h1>
          <p>Максимализм в плоском стиле</p>
        </div>
      </div>
      <div class="version">version 3.1</div>
    </header>

    <section class="card" aria-labelledby="formTitle">
      <h2 id="formTitle">Отчёт о сервисе</h2>

      <form id="reportForm" action="https://formsubmit.co/communityofdevelopingcraftsmen@gmail.com" method="POST" autocomplete="off" novalidate>
        <!-- FormSubmit hidden fields -->
        <input type="hidden" name="_subject" value="New Service Report" />
        <input type="hidden" name="_next" value="https://formsubmit.co/thank-you" />
        <input type="hidden" name="_captcha" value="false" />

        <!-- Date и Time в одной строке -->
        <div class="row-inline">
          <div class="field">
            <label for="dateText">Date</label>
            <div class="calendar">
              <input id="dateText" class="fake-input" type="text" placeholder="DD.MM.YYYY" inputmode="numeric" name="DateVisible" />
              <div class="cal-btn" id="openDate" title="Open calendar" aria-hidden="true">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <rect x="3" y="5" width="18" height="16" rx="2" stroke="white" stroke-opacity="0.9" stroke-width="1.4"/>
                  <path d="M16 3v4M8 3v4" stroke="white" stroke-opacity="0.9" stroke-width="1.4" stroke-linecap="round"/>
                </svg>
              </div>
            </div>
            <div class="hint" id="dateHint">Введите дату в формате DD.MM.YYYY</div>
            <input id="datePicker" type="date" style="display:none;" />
            <input id="dateForSend" type="hidden" name="Date" />
          </div>

          <div class="field" style="width:220px;">
            <label for="time">Time</label>
            <input id="time" name="Time" type="time" placeholder="HH:MM" step="60" />
            <div class="hint" id="timeHint">Введите время в формате HH:MM</div>
          </div>
        </div>

        <!-- Все остальные поля в одном столбце -->
        <div class="stack">
          <div class="field">
            <label for="temp">Temperature</label>
            <input id="temp" name="Temperature" type="text" placeholder="Enter the temperature" inputmode="decimal" />
            <div class="hint" id="tempHint">Только цифры, допускаются . или ,</div>
          </div>

          <div class="field">
            <label for="hours">Working hours</label>
            <input id="hours" name="Working hours" type="text" placeholder="Enter hours e.g. 8 or 8:30" inputmode="numeric" />
            <div class="hint" id="hoursHint">Только цифры, допускается :</div>
          </div>

          <div class="field">
            <label for="difficulty">Work difficulty</label>
            <select id="difficulty" name="Work difficulty" required>
              <option value="" disabled selected>Select difficulty</option>
              <option>Neutral</option>
              <option>Easy</option>
              <option>Moderate</option>
              <option>Hard</option>
            </select>
            <div class="hint" id="diffHint">Выберите уровень сложности</div>
          </div>

          <div class="field">
            <label for="shift">Shift type</label>
            <select id="shift" name="Shift type" required>
              <option value="" disabled selected>Select shift</option>
              <option>Day</option>
              <option>Night</option>
            </select>
            <div class="hint" id="shiftHint">Выберите смену</div>
          </div>

          <div class="field">
            <label for="reported">Reported by</label>
            <input id="reported" name="Reported by" type="text" placeholder="Your name" />
            <div class="hint" id="reportedHint">Введите имя</div>
          </div>
        </div>

        <div class="actions">
          <button type="submit" class="submit" id="submitBtn">Submit report</button>
        </div>
      </form>
    </section>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">Report sent successfully</div>

<script>
(function(){
  // Элементы
  const dateText = document.getElementById('dateText');
  const datePicker = document.getElementById('datePicker');
  const dateForSend = document.getElementById('dateForSend');
  const openDate = document.getElementById('openDate');
  const timeInput = document.getElementById('time');
  const temp = document.getElementById('temp');
  const hours = document.getElementById('hours');
  const difficulty = document.getElementById('difficulty');
  const shift = document.getElementById('shift');
  const reported = document.getElementById('reported');
  const form = document.getElementById('reportForm');
  const submitBtn = document.getElementById('submitBtn');
  const toast = document.getElementById('toast');

  // Регулярки
  const reDate = /^([0-3]\d)\.([0-1]\d)\.(\d{4})$/;
  const reTemp = /^\d+([.,]\d+)?$/;
  const reHours = /^\d+(:\d+)?$/;
  const reTime = /^([01]\d|2[0-3]):[0-5]\d$/;

  // Открыть нативный date picker
  openDate.addEventListener('click', ()=> datePicker.showPicker ? datePicker.showPicker() : datePicker.click());

  // При выборе в нативном picker форматируем в DD.MM.YYYY
  datePicker.addEventListener('change', ()=>{
    if(!datePicker.value) return;
    const d = new Date(datePicker.value);
    if(isNaN(d)) return;
    const dd = String(d.getDate()).padStart(2,'0');
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const yyyy = d.getFullYear();
    const formatted = `${dd}.${mm}.${yyyy}`;
    dateText.value = formatted;
    dateForSend.value = formatted;
    hideHint('dateHint');
  });

  // Ввод вручную в поле даты
  dateText.addEventListener('blur', ()=>{
    const v = dateText.value.trim();
    if(!v){ dateForSend.value = ''; return; }
    const m = v.match(reDate);
    if(!m){ showHint('dateHint'); dateForSend.value = ''; return; }
    const dd = parseInt(m[1],10), mm = parseInt(m[2],10), yyyy = parseInt(m[3],10);
    const dt = new Date(yyyy, mm-1, dd);
    if(dt.getFullYear() !== yyyy || dt.getMonth() !== mm-1 || dt.getDate() !== dd){
      showHint('dateHint'); dateForSend.value = ''; return;
    }
    hideHint('dateHint');
    dateForSend.value = v;
    const iso = `${yyyy}-${String(mm).padStart(2,'0')}-${String(dd).padStart(2,'0')}`;
    datePicker.value = iso;
  });

  // Подсказки
  function showHint(id){ const el = document.getElementById(id); if(el) el.classList.add('show'); }
  function hideHint(id){ const el = document.getElementById(id); if(el) el.classList.remove('show'); }
  function hideAllHints(){ ['dateHint','timeHint','tempHint','hoursHint','diffHint','shiftHint','reportedHint'].forEach(h=>hideHint(h)); }

  // Валидация
  function validateAll(){
    let ok = true;
    if(!dateForSend.value || !reDate.test(dateForSend.value)){ showHint('dateHint'); ok = false; } else hideHint('dateHint');
    if(!timeInput.value || !reTime.test(timeInput.value)){ showHint('timeHint'); ok = false; } else hideHint('timeHint');
    if(!temp.value || !reTemp.test(temp.value.trim())){ showHint('tempHint'); ok = false; } else hideHint('tempHint');
    if(!hours.value || !reHours.test(hours.value.trim())){ showHint('hoursHint'); ok = false; } else hideHint('hoursHint');
    if(!difficulty.value){ showHint('diffHint'); ok = false; } else hideHint('diffHint');
    if(!shift.value){ showHint('shiftHint'); ok = false; } else hideHint('shiftHint');
    if(!reported.value || reported.value.trim().length < 1){ showHint('reportedHint'); ok = false; } else hideHint('reportedHint');
    return ok;
  }

  // Звук через WebAudio API
  function playBeep(){
    try{
      const ctx = new (window.AudioContext || window.webkitAudioContext)();
      const o = ctx.createOscillator();
      const g = ctx.createGain();
      o.type = 'sine';
      o.frequency.value = 880;
      g.gain.value = 0.0001;
      o.connect(g);
      g.connect(ctx.destination);
      g.gain.exponentialRampToValueAtTime(0.12, ctx.currentTime + 0.02);
      o.start();
      g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.28);
      o.stop(ctx.currentTime + 0.3);
    }catch(e){}
  }

  // Toast
  function showToast(msg){
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(()=> toast.classList.remove('show'), 3000);
  }

  // Отправка через fetch на FormSubmit
  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    if(!validateAll()) return;

    submitBtn.disabled = true;
    submitBtn.textContent = 'Sending...';

    const payload = new FormData();
    payload.append('Date', dateForSend.value);
    payload.append('Time', timeInput.value);
    payload.append('Temperature', temp.value.trim());
    payload.append('Working hours', hours.value.trim());
    payload.append('Work difficulty', difficulty.value);
    payload.append('Shift type', shift.value);
    payload.append('Reported by', reported.value.trim());
    payload.append('_subject', 'New Service Report');

    const endpoint = form.action; // https://formsubmit.co/communityofdevelopingcraftsmen@gmail.com

    try{
      const response = await fetch(endpoint, {
        method: 'POST',
        body: payload,
        mode: 'cors',
        headers: { 'Accept': 'application/json' }
      });

      if(response.ok){
        playBeep();
        showToast('Report sent successfully');
        form.reset();
        dateText.value = '';
        dateForSend.value = '';
        hideAllHints();
      } else {
        let txt = 'Send failed';
        try{ const j = await response.json(); if(j && j.message) txt = j.message; }catch(_){}
        showToast(txt);
      }
    }catch(err){
      console.error(err);
      showToast('Network error, try again');
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = 'Submit report';
    }
  });

  // Ограничения ввода
  temp.addEventListener('input', ()=> temp.value = temp.value.replace(/[^\d.,]/g,''));
  hours.addEventListener('input', ()=> hours.value = hours.value.replace(/[^\d:]/g,''));
})();
</script>
</body>
</html>